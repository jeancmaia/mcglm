<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MCGLM, a unified model for statistical analysis.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="tutorial_mcglm_files/libs/clipboard/clipboard.min.js"></script>
<script src="tutorial_mcglm_files/libs/quarto-html/quarto.js"></script>
<script src="tutorial_mcglm_files/libs/quarto-html/popper.min.js"></script>
<script src="tutorial_mcglm_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tutorial_mcglm_files/libs/quarto-html/anchor.min.js"></script>
<link href="tutorial_mcglm_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tutorial_mcglm_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tutorial_mcglm_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tutorial_mcglm_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tutorial_mcglm_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MCGLM, a unified model for statistical analysis.</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The Multivariate Covariance Generalized Linear Model (MCGLM) is a universalization of the classic statistical model GLM, widening for multivariate and non-independent response fitting. Due to its pliancy and explicit specification, this unified model can support many statistical analyses on a wide variety of data and distinct traits. Aiming to foment the pervasiveness of statistical analysis with MCGLM support, this essay instills MCGLM and its comprehensive new Python library - the <code>mcglm</code>. The library is hosted on PyPI and can be installed with the aid of some Python library manager, such as pip. https://pypi.org/project/mcglm/.</p>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>Dated at the beginning of the 19th century and controversial about actual authorship, the least squares method established an optimization proposal <code>[1]</code>. According to the Gauss-Markov theorem <code>[2]</code>, the resulting estimates are optimal and unbiased under linear conditions of continuous values. This optimization method is leveraged by <code>linear regression</code>, one of the primordial statistical models <code>[3]</code>, <code>[4]</code>. A linear regression associates a response variable to a group of covariates by employing a linear operation on regression parameters <code>[5]</code>. Three main assumptions for linear regression are linearity, independent realizations of the response variable, and a gaussian homoscedastic error with a zero mean. Aiming to generalize it, some subsequential statistical proposals expanded these assumptions.</p>
<p>The Generalized Linear Model (GLM) <code>[6]</code> generalizes the gaussian assumption of linear regression to some models of the exponential family <code>[7]</code>; The Generalized Additive Model (GAM) <code>[8]</code> manages regression by the sum of smooth operations on covariates; The Generalized Estimating Equations (GEE) <code>[9]</code> applies the quasi-likelihood estimating functions to adjust longitudinal data; Copulas <code>[10]</code>, <code>[11]</code> and Mixed Models <code>[12]</code> are consolidated models that can fit non-independent response data, to cite a few. Amid the most recent postulations resides the family of Multivariate Covariance Generalized Linear Models (MCGLM).</p>
<p>The Multivariate Covariance Generalized Linear Model (MCGLM) <code>[13]</code> universalizes GLM by allowing the multivariate analysis of non-independent responses, such as longitudinal and spatial data. This versatility is the main trait of MCGLM; it stems from two-moment assumptions and the specification of its five fundamental components: linear predictor via design matrix, link function, variance function, covariance link function, and the linear matrix predictor through Z matrices. The model allows the assessment of regression coefficients and dispersion parameters, hypothesis tests, goodness-of-fit measurements, and correlation coefficients between outcome variables.</p>
</section>
<section id="statistical-models-and-a-brief-literary-review." class="level3">
<h3 class="anchored" data-anchor-id="statistical-models-and-a-brief-literary-review.">Statistical models and a brief literary review.</h3>
<p>To develop intuition on statistical models, we dissect classical linear regression. According to McCullagh, P and Nelder, J.A, 1989 in their fantastic book “Generalized Linear Models”, yet rephrased by myself, an enthusiast disciple, a linear regression can be decomposed into two components: <code>systematic</code> and <code>random</code> parts.</p>
<p>Assuming an outcome variable <span class="math inline">\(\boldsymbol{y}\)</span> with <span class="math inline">\(n\)</span> components considered independent realizations of a random variable <span class="math inline">\(\boldsymbol{Y}\)</span>. There is a vector <span class="math inline">\(\boldsymbol{\mu}\)</span> which holds the mean parameters of those realizations. The systematic part of the model specifies the vector <span class="math inline">\(\boldsymbol{\mu}\)</span> by employing a linear operation between regression parameters <span class="math inline">\(\beta_0,...,\beta_p\)</span> and the covariates. The mathematical notation for the systematic part:</p>
<p><span class="math display">\[\begin{equation*}
    \mathrm{E}(Y_i) =  
    \mathrm{\mu_i} =
    \beta_0 +
    \sum_{j=1}^{p} x_{ij}\beta_j;\qquad i = 1,...,n.
    %\mathrm{V}(\boldsymbol{\mu}_r;p_r)^{\frac{1}{2}} (\boldsymbol{\Omega}(\boldsymbol{\tau}_r))
    %\mathrm{V}(\boldsymbol{\mu}_r;p_r)^{\frac{1}{2}}.
  \end{equation*}\]</span></p>
<p>where <span class="math inline">\(x_{ij}\)</span> is the value of the jth covariate for observation <span class="math inline">\(i\)</span>.</p>
<p>Moreover, as the random part, we assume independence and constant variance of errors. These errors follow a Gaussian distribution with mean 0 and constant variance <span class="math inline">\(\sigma^2\)</span> - giving to linear regression the adjective <code>Homoscedasticity</code>.</p>
<p>For a simple linear regression, the model graphically shapes as the image below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="linear_regression.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Linear Regression</figcaption><p></p>
</figure>
</div>
<p>As a statistical model, linear regression associates a response variable with at least one explanatory variable.</p>
<p>In 1972, Nelder and Wedderburn went a step further in unifying the theory of statistical modeling and, in particular, regression models, publishing their article on generalized linear models (GLM).</p>
<p>In the context of GLM, each component of the random variable <span class="math inline">\(Y\)</span> assumes a distribution in the <code>exponential family</code>, in which the probability or density function takes the form.</p>
<p><span class="math display">\[\begin{equation*}
    \mathrm{f}_y(y;\theta,\phi) =
    \mathrm{exp\{(y\theta - b(\theta))/a(\phi) + c(y,\phi)\}}
\end{equation*}\]</span></p>
<p>for some specific functions <span class="math inline">\(a(\phi)\)</span>, <span class="math inline">\(b(\theta)\)</span> and <span class="math inline">\(c(y,\phi)\)</span>. Mean and Variance can be specified as:</p>
<p><span class="math display">\[\begin{equation*}
    \mathrm{E}(Y) = b'(\theta).\qquad
    \mathrm{Var}(Y) = b''(\theta)a(\phi).
\end{equation*}\]</span></p>
<p>A couple of possible models in this framework:</p>
<span class="math display">\[\begin{array}{lll} \hline
    \text{Distribution}  &amp; \text{Support} &amp; \text{Cases} \\ \hline
    \text{Gaussian}  &amp; \text{Real Numbers} &amp; \text{General Symmetric Distributions.} \\
    \text{Binomial(Bernoulli)}  &amp; \text{Bounded Data} &amp; \text{Probability/Odds of an event.} \\
    \text{Poisson}  &amp; \text{Integer Positive} &amp; \text{Positive Count Distributions.} \\
    \text{Gamma}  &amp; \text{Real Positive Numbers} &amp; \text{Positive Asymmetric Distributions.} \\
    \text{Inverse Gaussian} &amp; \text{Real Positive Numbers} &amp; \text{Positive Asymmetric Distributions.} \\ \hline
\end{array}\]</span>
<p>GLM relies on three components: A design matrix with covariates, a link function, some distribution of exponential family or a variance function. The usual choices for the link and variance functions.</p>
<span class="math display">\[\begin{array}{lll} \hline
    \text{Distribution}  &amp; \text{Canonical link function} &amp; \text{Variance function} \\ \hline
    \text{Poisson}     &amp; \text{Log} &amp; \text{$\mu$} \\
    \text{Binomial}    &amp; \text{Logit} &amp; \text{$\mu(\mu - 1)$} \\
    \text{Normal}  &amp; \text{Identity} &amp; \text{1} \\
    \text{Gamma}  &amp; \text{Reciprocal} &amp; \text{$\mu^2$} \\
    \text{Inverse Gaussian}  &amp; \text{Reciprocal²} &amp; \text{$\mu^3$} \\ \hline
\end{array}\]</span>
<p>The <code>maximum-likelihood</code> estimator leverages the underlying distribution to find regression coefficients and dispersion estimates that maximize the product of likelihood. Therefore, two assumptions of GLM are: linearity upon the link function and random variable <span class="math inline">\(Y\)</span> is independently distributed as some exponential family distribution. The figure below illustrates the <code>Binomial</code> and <code>Poisson</code> models.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="regressao_binomial.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Binomial Regression</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="regressao_poisson.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Poisson Regression</figcaption><p></p>
</figure>
</div>
<p>Stepping ahead two years, Wedderburn, one of the authors of GLM, published in 1974 one of the most iconic papers of history. “Quasi-Likelihood Functions, Generalized Linear Models, and the Gauss-Newton Method”. He proposed a relative likelihood estimator, the <code>quasi-likelihood</code>, which does not rely on a distribution model, yet provides asymptotically unbiased and consistent estimators. As long as statisticians cannot know the distribution upfront, the <code>quasi-likelihood</code> play an essential role in statistical models. The <code>quasi-score</code> is an <code>Estimating Equation</code> for quasi-likelihood functions.</p>
<hr>
<p>In 1986, Liang and Zeger published the paper “Longitudinal data analysis using generalized linear models”, which establishes an extension of Generalized Linear Models (GLM) to longitudinal data analysis. The paper epitomizes that data scenario.</p>
<pre><code>The severity of respiratory disease, along with the nutritional status, age, and family income of children, might be observed once every three months for 18 months. The dependence of the outcome variable, severity of disease, on the covariates is of interest.</code></pre>
<p>The paper introduces an <code>Estimating Equation</code> that gives consistent estimates of the regression coefficients and their variances under weak assumptions about the joint distribution, the model GEE. The dispersion parameters remain a nuisance. The model harnesses the correlation matrix to define the dependence between components of the response variable. Furthermore, the paper suggests some dependences structures for GEE: <code>independent</code>, <code>autoregressive</code>, <code>exchangeable</code>, <code>unstructured</code>, <code>stationary-M</code>, <code>M-dependent</code>, or <code>non-stationary</code>. The GEE relies on the specification of four components: design matrix with covariates; link function; variance function; correlation matrix.</p>
<p>Finally, in 2016, Bonat and Jørgensen published the MCGLM, A brand new family of Statistical Models: Multivariate Covariance Generalized Linear Models.</p>
</section>
<section id="mcglm" class="level3">
<h3 class="anchored" data-anchor-id="mcglm">MCGLM</h3>
<p>The two-moment assumptions entail distinct apparatus for mean and variance. The optimization process of MCGLM blends two second-order optimization algorithms, the <code>Fisher Scoring</code> <code>[14]</code>, <code>[15]</code> for regression, and <code>Chaser</code> <code>[16]</code> for dispersion parameters in tandem. Moreover, the estimating functions <code>Quasi-score</code> <code>[17]</code> and <code>Pearson Estimating Equation</code> are leveraged for the first and second moment, respectively.</p>
<p>Let <span class="math inline">\(\mathbf{Y}_{N \times R} = \{\boldsymbol{Y}_1, \ldots, \boldsymbol{Y}_R\}\)</span> be a response matrix, and <span class="math inline">\(\mathbf{M}_{N \times R} = \{\boldsymbol{\mu}_1, \ldots, \boldsymbol{\mu}_R\}\)</span> denote the corresponding matrix of expected values. Let <span class="math inline">\(\boldsymbol{\Sigma}_r\)</span> the <span class="math inline">\(N \times N\)</span> variance-covariance matrix of the outcome <span class="math inline">\(r\)</span>, for <span class="math inline">\(r = 1, \ldots, R\)</span>. Similarly, let <span class="math inline">\(\boldsymbol{\Sigma}_b\)</span> be a <span class="math inline">\(R \times R\)</span> correlation matrix inter responses. Let <span class="math inline">\(\boldsymbol{X}_r\)</span> denote an $N k_r $ design matrix and <span class="math inline">\(\boldsymbol{\beta}_r\)</span> a <span class="math inline">\(k_r \times 1\)</span> regression parameter vector. The two-moment specification of the MCGLM model goes as it follows:</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{E}(\mathbf{Y}) = \mathbf{M} = \{g_1^{-1}(\boldsymbol{X}_1 \boldsymbol{\beta}_1), \ldots, g_R^{-1}(\boldsymbol{X}_R \boldsymbol{\beta}_R)\}
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*}
\mathrm{Var}(\mathbf{Y}) = \boldsymbol{C} = \boldsymbol{\Sigma}_R \overset{G} \otimes \boldsymbol{\Sigma}_b
\end{equation*}\]</span></p>
<p>where the <span class="math inline">\(C\)</span> leverages the generalized Kronecker product <span class="math inline">\(\boldsymbol{\Sigma}_R \overset{G} \otimes \boldsymbol{\Sigma}_b = \mathrm{Bdiag}(\tilde{\boldsymbol{\Sigma}}_1, \ldots, \tilde{\boldsymbol{\Sigma}}_R)(\boldsymbol{\Sigma}_b \otimes \boldsymbol{I})\mathrm{Bdiag}(\tilde{\boldsymbol{\Sigma}}_1^T, \ldots, \tilde{\boldsymbol{\Sigma}}_R^T)\)</span> <code>[18]</code>. The matrix <span class="math inline">\(\tilde{\boldsymbol{\Sigma}}_r\)</span> denotes a low triangular Cholesky decomposition of <span class="math inline">\(\boldsymbol{\Sigma}_r\)</span>. The operator <span class="math inline">\(\mathrm{Bdiag}\)</span> denotes a block diagonal matrix and <span class="math inline">\(\boldsymbol{I}\)</span> denotes an <span class="math inline">\(N \times N\)</span> identity matrix. Regarding the mean, or expectation, operation <span class="math inline">\(g_r(\cdot)\)</span> is a usual link function from GLM. <span class="math inline">\(\boldsymbol{\Sigma}_r\)</span> is defined by:</p>
<p><span class="math display">\[\begin{equation*}
\boldsymbol{\Sigma}_r =
\mathrm{V}(\boldsymbol{\mu}_r;p_r)^{\frac{1}{2}} (\boldsymbol{\Omega}(\boldsymbol{\tau}_r))
\mathrm{V}(\boldsymbol{\mu}_r;p_r)^{\frac{1}{2}},
\end{equation*}\]</span> where <span class="math inline">\(\mathrm{V}(\boldsymbol{\mu}_r;p_r) = \mathrm{diag}(\vartheta(\boldsymbol{\mu}_r;p_r))\)</span> is a diagonal matrix, whose main entries are the variance function applied on the expected values <span class="math inline">\(\boldsymbol{\mu_r}\)</span>. Each variance function establishes its unique marginal distributions on MCGLM. Furthermore, MCGLM leverages linear matrix predictor with covariance link function for dispersion matrix definition <code>[19]</code>, <code>[20]</code>, <code>[21]</code>. <span class="math display">\[\begin{equation}
h(\boldsymbol{\Omega}(\boldsymbol{\tau}_r)) = \tau_{r0} Z_{r0} + \cdots + \tau_{rD} Z_{rD},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathrm{h(\cdot)}\)</span> is the covariance link function and matrices <span class="math inline">\(Z_r\)</span> specifies the dependence inner response. The main article details many structures that can be fitted through linear matrix predictor.</p>
<p>As the mathematical notation alludes, it is up to the user to pick their choices for the link, variance, covariance functions, and dependence matrices.</p>
</section>
<section id="mcglm-components" class="level3">
<h3 class="anchored" data-anchor-id="mcglm-components">MCGLM components</h3>
<p>The variance function is fundamental to the MCGLM, as it defines the marginal distribution of a response variable. To highlight some common choices, the variance function <code>power</code> specializes in handling continuous data and is fundamental to the <code>Tweedie</code> family of distribution models. According to <code>[23]</code> and <code>[24]</code>, this family has its emblematic cases: <code>Gaussian</code> (p = 0), <code>Gamma</code> (p = 2), and <code>Inverse Gaussian</code> (p = 3). The variance function <code>extended binomial</code> is a common choice for analyzing limited data. For the adjustment of count data, the dispersion function presented by <code>[25]</code>, called <code>Poisson-Tweedie</code>, is flexible to capture notable models, such as: <code>Hermite</code> (p = 0), <code>Neyman Type A</code> (p = 1), <code>Negative Binomial</code> (p = 2) and <code>Gaussian Poisson-inverse</code> (p = 3). The following table summarizes the variance functions cited:</p>
<span class="math display">\[\begin{array}{ll} \hline
    \text{Function name}  &amp; \text{Formula} \\ \hline
    \text{power/Tweedie}  &amp; \mathrm{V}(p) = \mu^{p}  \\
    \text{binomial}  &amp; \mathrm{V}(p) = \mu^{p} (1 - \mu_r)^{p} \\
    \text{Poisson-Tweedie}  &amp; \mathrm{V}(p) = \mu + \tau\mu_{p}  \\  \hline
\end{array}\]</span>
<p>The covariance link function <span class="math inline">\(h(\cdot)\)</span> is described by . To cite a few examples: <code>identity</code>, <code>inverse</code> and <code>exponential-matrix</code> <code>[22]</code>.</p>
<p>In MCGLM, the user specifies the dependency through dependency matrices <code>Z</code>, supporting the flexible profile of the model. Many classical statistical models are replicable by specifying <code>Z</code> matrices. To cite a few, mixed models, moving averages and compound symmetry. For in-deep details, see <code>[13]</code>.</p>
<p>The brand new library <code>mcglm</code>.</p>
<p>The Python library <code>mcglm</code> provides an easy interface for fitting the MCGLM model, similar to the library <code>statsmodels</code>, providing auxiliary methods to lead a proper specification of each MCGLM component. The library provides a comprehensive report for the model fitting analysis with regression coefficients, dispersion estimates, confidence intervals, hypothesis testing, and Pearson residuals. Only R users have access to the MCGLM algorithm by the package <code>mcglm</code>.</p>
<p>Finally, this notebook presents some statistical analysis with the support of Python <code>mcglm</code>.</p>
<p>Refs:</p>
<p>https://www.jstor.org/stable/44681850<br>
https://www.researchgate.net/publication/324579147_Multiple_Response_Variables_Regression_Models_in_R_The_mcglm_Package</p>
</section>
<section id="modeling-time" class="level3">
<h3 class="anchored" data-anchor-id="modeling-time">Modeling time</h3>
<div class="cell" data-tags="[]" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>sys.path.append(os.path.join(sys.path[<span class="dv">0</span>], <span class="st">".."</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mcglm <span class="im">import</span> MCGLM, mc_mixed, mc_id, mc_ma</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> patsy <span class="im">import</span> dmatrix</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tools.tools <span class="im">import</span> add_constant</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.seasonal <span class="im">import</span> seasonal_decompose</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.stattools <span class="im">import</span> adfuller</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.arima_process <span class="im">import</span> ArmaProcess</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-tags="[]" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library docstring.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MCGLM.__doc__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    MCGLM class that implements MCGLM stastical models. (Bonat, Jørgensen 2015)
        
    It extends GLM for multi-responses and dependent components by fitting second-moment assumptions.

    Parameters
    ----------
    endog : array_like
        1d array of endogenous response variable. In case of multiple responses, the user must pass the responses on a list.  
    exog : array_like
        A dataset with the endogenous matrix in a Numpy fashion. Since the library doesn't set an intercept by default, the user must add it. In the case of multiple responses, the user must pass the design matrices as a python list. 
    z : array_like
        List with matrices components of the linear covariance matrix.
    link : array_like, string or None
        Specification for the link function. The MCGLM library implements the following options: identity, logit, power, log, probit, cauchy, cloglog, loglog, negativebinomial. In the case of None, the library chooses the identity link. In multiple responses, user must pass values as list.  
    variance : array_like, string or None
        Specification for the variance function. The MCGLM library implements the following options: constant, tweedie, binomialP, binomialPQ, geom_tweedie, poisson_tweedie. In the case of None, the library chooses the constant link. In multiple responses, user must pass values as list.   
    offset : array_like or None
        Offset for continuous or count. In multiple responses, user must pass values as list.   
    Ntrial : array_like or None
        Ntrial for binomial responses. In multiple responses, user must pass values as list.
    power_fixed : array_like or None
        Parameter that allows estimation of power when variance functions is either tweedie, geom_tweedie or poisson_tweedie. In multiple responses, user must pass values as list. 
    maxiter : float or None
        Number max of iterations. Defaults to 200.
    tol : float or None
        Threshold of minimum absolute change on paramaters. Defaults to 0.0001.
    tuning : float or None
        Step size parameter. Defaults to 0.5.
    weights : array_like or None
        Weight matrix. Defaults to None.
        
    Examples
    ----------
    &gt;&gt;&gt; import statsmodels.api as sm
    &gt;&gt;&gt; data = sm.datasets.scotland.load()
    &gt;&gt;&gt; data.exog = sm.add_constant(data.exog)
    
    &gt;&gt;&gt; model = sm.GLM(data.endog, data.exog, z=[mc_id(data.exog)],
    ...                      link="log", variance="tweedie",
    ...                      power=2, power_fixed=False)
    
    &gt;&gt;&gt; model_results = model.fit()
    &gt;&gt;&gt; model_results.mu
    &gt;&gt;&gt; model_results.pearson_residuals
    &gt;&gt;&gt; model_results.aic
    &gt;&gt;&gt; model_results.bic
    &gt;&gt;&gt; model_results.loglikelihood
    
    Notes
    -----
    MCGLM is a brand new model, which provides a solid statistical model for fitting multi-responses non-gaussian, dependent, or independent data based on second-moment assumptions. When a user instantiates an mcglm object, she must specify attributes such as link, variance, and z matrices; it will drive the overall behavior of the model.
    For more details, check articles and documentation provided.
    </code></pre>
</div>
</div>
<p>To instill <code>mcglm</code>, we begin with statistical analysis of i.i.d(independent and identically distributed) outcomes. For that, components <code>Z</code> will be specified as identity matrices, using method <code>mc_id()</code>. Upcoming examples epitomize the flexibility of <code>mcglm</code> in fitting different distribution models.</p>
<section id="diabetes-dataset" class="level5">
<h5 class="anchored" data-anchor-id="diabetes-dataset">1. Diabetes dataset</h5>
<p>Diabetes dataset outputs suited for regression modeling.</p>
<div class="cell" data-tags="[]" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_diabetes</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> load_diabetes(return_X_y<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.DataFrame(X)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pd.Series(y, name<span class="op">=</span><span class="st">"output"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># looking at target distribution</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(y)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram of California Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Text(0.5, 1.0, 'Histogram of California Dataset')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-4-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Starting with linear regression, fitting a linear regression through the <code>mcglm</code> library is plain. The picks are <code>identity</code> as a link, <code>constant</code> as variance, and an <code>identity matrix</code> as Z.</p>
<div class="cell" data-tags="[]" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>modelresults <span class="op">=</span> MCGLM(endog<span class="op">=</span>y, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                     exog<span class="op">=</span>X, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                     z<span class="op">=</span>[mc_id(X)]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                     ).fit()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>[modelresults.summary()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[&lt;class 'statsmodels.iolib.summary.Summary'&gt;
 """
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:                 output   No. Iterations:                      1
 Model:                          MCGLM   No. Observations:                  442
 link:                        identity   Df Residuals:                      431
 variance:                    constant   Df Model:                           11
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                           5327.73
 Time:                        15:31:52   pBIC                           5372.73
                                         pLogLik                     -2652.8628
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 0            -10.0099    177.919     -0.056      0.955    -358.725     338.705
 1           -239.8156    182.306     -1.315      0.188    -597.128     117.497
 2            519.8459    198.121      2.624      0.009     131.536     908.156
 3            324.3846    194.811      1.665      0.096     -57.438     706.208
 4           -792.1756   1240.774     -0.638      0.523   -3224.047    1639.696
 5            476.7390   1009.552      0.472      0.637   -1501.947    2455.425
 6            101.0433    632.868      0.160      0.873   -1139.356    1341.442
 7            177.0632    480.837      0.368      0.713    -765.359    1119.486
 8            751.2737    511.877      1.468      0.142    -251.987    1754.535
 9             67.6267    196.486      0.344      0.731    -317.478     452.731
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1    2.6e+04    796.484     32.649      0.000    2.44e+04    2.76e+04
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
 ==============================================================================
 """]</code></pre>
</div>
</div>
<p>The residual analysis is key for assessing the fulfillment of the assumptions. For more details, check out (Montgomery. D.C and Runger. G.C, 2013).</p>
<div class="cell" data-tags="[]" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Analysis</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(modelresults.mu, modelresults.pearson_residuals)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"mu"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"pearson residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Text(0, 0.5, 'pearson residuals')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-6-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As long as the Pearson residuals aren’t shapeless, they may point to a non-optimal fitting.</p>
</section>
<section id="a-count-analysis" class="level5">
<h5 class="anchored" data-anchor-id="a-count-analysis">2. A count analysis</h5>
<p>This dataset hosts information from a Canadian study of mortality by age and smoking status. https://data.princeton.edu/wws509/datasets/#smoking. The four-column dataset establishes features: age, smoking status, population, and the outcome of deaths.</p>
<p>Linear regression is unsuitable for analyzing discrete count data, and a Poisson model is a usual choice. With <code>mcglm</code> is easy to leverage the Poisson Model.</p>
<div class="cell" data-tags="[]" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>smoking_data <span class="op">=</span> pd.read_csv(<span class="st">"data/smoking_data.csv"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">## exog and endog</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dmatrix(<span class="st">"~ pop + age + smoke"</span>, smoking_data, return_type<span class="op">=</span><span class="st">"dataframe"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> smoking_data[<span class="st">"dead"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-tags="[]" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(y, bins<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram of absolute count of deads"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Text(0.5, 1.0, 'Histogram of absolute count of deads')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>That is a long-tail distribution.</p>
<p>Straight off the bat, we attempt fitting as a linear regression: <code>identity</code> and <code>constant</code>.</p>
<div class="cell" data-tags="[]" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>modelresults <span class="op">=</span> MCGLM(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    [mc_id(X)],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>[modelresults.summary()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>[&lt;class 'statsmodels.iolib.summary.Summary'&gt;
 """
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:                   dead   No. Iterations:                      1
 Model:                          MCGLM   No. Observations:                   36
 link:                        identity   Df Residuals:                       22
 variance:                    constant   Df Model:                           14
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                            429.44
 Time:                        15:32:20   pBIC                            451.61
                                         pLogLik                       -200.719
 =============================================================================================
                                 coef    std err          z      P&gt;|z|      [0.025      0.975]
 ---------------------------------------------------------------------------------------------
 Intercept                  -224.6373     66.931     -3.356      0.001    -355.820     -93.455
 age[T.45-59]                 95.3834     76.446      1.248      0.212     -54.448     245.215
 age[T.50-54]                147.8634     78.491      1.884      0.060      -5.977     301.703
 age[T.55-59]                216.4651     74.395      2.910      0.004      70.654     362.276
 age[T.60-64]                344.0038     76.451      4.500      0.000     194.162     493.846
 age[T.65-69]                426.7793     74.466      5.731      0.000     280.829     572.730
 age[T.70-74]                399.1722     78.027      5.116      0.000     246.242     552.103
 age[T.75-79]                335.9303     83.318      4.032      0.000     172.629     499.231
 age[T.80+]                  293.7420     86.312      3.403      0.001     124.573     462.911
 smoke[T.2.cigarPipeOnly]     32.3389     49.616      0.652      0.515     -64.906     129.584
 smoke[T.3.cigarrettePlus]    85.2001     76.811      1.109      0.267     -65.347     235.747
 smoke[T.4.cigarretteOnly]    87.8965     60.879      1.444      0.149     -31.425     207.218
 pop                           0.1128      0.023      4.814      0.000       0.067       0.159
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1  1.107e+04   1899.730      5.825      0.000    7342.638    1.48e+04
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
 ==============================================================================
 """]</code></pre>
</div>
</div>
<p>Let’s try a <code>Tweedie</code> with a power set as one, as a <code>Poisson</code> model. As mentioned, Poisson is a suitable pick for modeling count data.</p>
<div class="cell" data-tags="[]" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>modelresults <span class="op">=</span> MCGLM(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    [mc_id(X)],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    link<span class="op">=</span><span class="st">"log"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    variance<span class="op">=</span><span class="st">"tweedie"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    power<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    power_fixed<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>[modelresults.summary()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>[&lt;class 'statsmodels.iolib.summary.Summary'&gt;
 """
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:                   dead   No. Iterations:                      1
 Model:                          MCGLM   No. Observations:                   36
 link:                             log   Df Residuals:                       22
 variance:                     tweedie   Df Model:                           14
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                            371.22
 Time:                        15:32:29   pBIC                            393.39
                                         pLogLik                      -171.6087
 =============================================================================================
                                 coef    std err          z      P&gt;|z|      [0.025      0.975]
 ---------------------------------------------------------------------------------------------
 Intercept                     2.5604      0.283      9.056      0.000       2.006       3.115
 age[T.45-59]                  0.6242      0.310      2.011      0.044       0.016       1.233
 age[T.50-54]                  1.0038      0.308      3.261      0.001       0.401       1.607
 age[T.55-59]                  1.3818      0.245      5.635      0.000       0.901       1.862
 age[T.60-64]                  1.5012      0.245      6.133      0.000       1.021       1.981
 age[T.65-69]                  2.1366      0.240      8.920      0.000       1.667       2.606
 age[T.70-74]                  2.3557      0.269      8.766      0.000       1.829       2.882
 age[T.75-79]                  2.2041      0.298      7.403      0.000       1.621       2.788
 age[T.80+]                    1.9506      0.318      6.143      0.000       1.328       2.573
 smoke[T.2.cigarPipeOnly]      0.2114      0.176      1.203      0.229      -0.133       0.556
 smoke[T.3.cigarrettePlus]     0.5030      0.214      2.347      0.019       0.083       0.923
 smoke[T.4.cigarretteOnly]     0.7818      0.164      4.755      0.000       0.460       1.104
 pop                           0.0004   6.25e-05      6.679      0.000       0.000       0.001
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1    14.1200      3.786      3.729      0.000       6.699      21.541
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
 ==============================================================================
 """]</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Analysis</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(modelresults.mu, modelresults.pearson_residuals)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"mu"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"pearson residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Text(0, 0.5, 'pearson residuals')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>By the <code>pAIC</code> metric, the usual <code>Tweedie</code> variance function is a suitable pick.</p>
<hr>
<p>It is plain to harness an essential trait of the <code>mcglm</code> library, the power estimation for a <code>Poisson Tweedie</code> fitting. We have got to set the parameter power_fixed as <code>False</code>.</p>
<div class="cell" data-tags="[]" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>modelresults <span class="op">=</span> MCGLM(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    [mc_id(X)],</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    link<span class="op">=</span><span class="st">"log"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    variance<span class="op">=</span><span class="st">"poisson_tweedie"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    power<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    power_fixed<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>[modelresults.summary()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>[&lt;class 'statsmodels.iolib.summary.Summary'&gt;
 """
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:                   dead   No. Iterations:                     12
 Model:                          MCGLM   No. Observations:                   36
 link:                             log   Df Residuals:                       22
 variance:             poisson_tweedie   Df Model:                           14
 Method:              Quasi-Likelihood   Power-fixed:                     False
 Date:                Sun, 05 Feb 2023   pAIC                            370.17
 Time:                        15:32:39   pBIC                            392.34
                                         pLogLik                      -171.0843
 =============================================================================================
                                 coef    std err          z      P&gt;|z|      [0.025      0.975]
 ---------------------------------------------------------------------------------------------
 Intercept                     2.4466      0.269      9.094      0.000       1.919       2.974
 age[T.45-59]                  0.6573      0.297      2.209      0.027       0.074       1.240
 age[T.50-54]                  1.0419      0.298      3.498      0.000       0.458       1.626
 age[T.55-59]                  1.3900      0.244      5.703      0.000       0.912       1.868
 age[T.60-64]                  1.5253      0.242      6.300      0.000       1.051       2.000
 age[T.65-69]                  2.1935      0.236      9.283      0.000       1.730       2.657
 age[T.70-74]                  2.4571      0.263      9.350      0.000       1.942       2.972
 age[T.75-79]                  2.3416      0.290      8.082      0.000       1.774       2.909
 age[T.80+]                    2.1177      0.307      6.906      0.000       1.517       2.719
 smoke[T.2.cigarPipeOnly]      0.1685      0.172      0.980      0.327      -0.168       0.505
 smoke[T.3.cigarrettePlus]     0.4427      0.217      2.041      0.041       0.017       0.868
 smoke[T.4.cigarretteOnly]     0.7345      0.167      4.398      0.000       0.407       1.062
 pop                           0.0005    6.4e-05      7.110      0.000       0.000       0.001
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1     3.0590      3.121      0.980      0.327      -3.059       9.177
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.2895      0.198      6.526      0.000       0.902       1.677
 ==============================================================================
 """]</code></pre>
</div>
</div>
<p>By the <code>pAIC</code>, the adjustment with <code>Poisson Tweedie</code> power set 1.263 is lightly better than <code>Poisson</code> 1. It points out that the distribution <code>Poisson Tweedie</code> is the best option for this data learning.</p>
</section>
<section id="a-bounded-analysis" class="level5">
<h5 class="anchored" data-anchor-id="a-bounded-analysis">3. A bounded analysis</h5>
<p>For a bound analysis, we analyze the iconic titanic dataset.</p>
<div class="cell" data-tags="[]" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="op">=</span> pd.read_csv(<span class="st">"data/titanic.csv"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> titanic[<span class="st">"Survived"</span>]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> titanic[[<span class="st">"Fare"</span>, <span class="st">"SibSp"</span>, <span class="st">"Embarked"</span>, <span class="st">"Parch"</span>, <span class="st">"Pclass"</span>]]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.fillna(<span class="st">"S"</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dmatrix(<span class="st">"~ Fare + SibSp + Embarked + Parch + Pclass"</span>, X, return_type<span class="op">=</span><span class="st">"dataframe"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>modelresults <span class="op">=</span> MCGLM(</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    [mc_id(X)],</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    link<span class="op">=</span><span class="st">"logit"</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    variance<span class="op">=</span><span class="st">"binomialP"</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    ntrial<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>[modelresults.summary()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>[&lt;class 'statsmodels.iolib.summary.Summary'&gt;
 """
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:               Survived   No. Iterations:                      1
 Model:                          MCGLM   No. Observations:                  891
 link:                           logit   Df Residuals:                      883
 variance:                   binomialP   Df Model:                            8
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                            212.54
 Time:                        15:32:47   pBIC                            250.88
                                         pLogLik                       -98.2698
 =================================================================================
                     coef    std err          z      P&gt;|z|      [0.025      0.975]
 ---------------------------------------------------------------------------------
 Intercept         1.4120      0.343      4.122      0.000       0.741       2.083
 Embarked[T.Q]     0.2911      0.307      0.949      0.343      -0.310       0.893
 Embarked[T.S]    -0.5179      0.196     -2.636      0.008      -0.903      -0.133
 Fare              0.0037      0.002      1.554      0.120      -0.001       0.008
 SibSp            -0.1274      0.082     -1.561      0.119      -0.287       0.033
 Parch             0.2920      0.101      2.906      0.004       0.095       0.489
 Pclass           -0.7556      0.116     -6.508      0.000      -0.983      -0.528
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1     0.9990      0.036     27.961      0.000       0.929       1.069
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
 ==============================================================================
 """]</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Evaluating multiple links</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>modelresults_logit <span class="op">=</span> MCGLM(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    y, X, [mc_id(X)], link<span class="op">=</span><span class="st">"logit"</span>, variance<span class="op">=</span><span class="st">"binomialP"</span>, ntrial<span class="op">=</span><span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>modelresults_loglog <span class="op">=</span> MCGLM(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    y, X, [mc_id(X)], link<span class="op">=</span><span class="st">"loglog"</span>, variance<span class="op">=</span><span class="st">"binomialP"</span>, ntrial<span class="op">=</span><span class="dv">1</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>modelresults_cloglog <span class="op">=</span> MCGLM(</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    y, X, [mc_id(X)], link<span class="op">=</span><span class="st">"cloglog"</span>, variance<span class="op">=</span><span class="st">"binomialP"</span>, ntrial<span class="op">=</span><span class="dv">1</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>modelresults_cauchy <span class="op">=</span> MCGLM(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    y, X, [mc_id(X)], link<span class="op">=</span><span class="st">"cauchy"</span>, variance<span class="op">=</span><span class="st">"binomialP"</span>, ntrial<span class="op">=</span><span class="dv">1</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>).fit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-tags="[]" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logit_aic: "</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    modelresults_logit.aic,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">", loglog_aic: "</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    modelresults_loglog.aic,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">", cloglog_aic: "</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    modelresults_cloglog.aic,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">", cauchy_aic: "</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    modelresults_cauchy.aic,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>logit_aic:  212.54 , loglog_aic:  202.04 , cloglog_aic:  222.58 , cauchy_aic:  216.94</code></pre>
</div>
</div>
<p>The loglog link is the best pick for this analysis.</p>
<p>In addition, the <code>mcglm</code> can fit response variables when its realizations are non-independent.</p>
</section>
</section>
<section id="non-independent-section" class="level3">
<h3 class="anchored" data-anchor-id="non-independent-section">Non-independent section</h3>
<p>Let’s leverage the <code>mcglm</code> to adjust non-independent data, illustrated by a Moving Average and Mixed Model analysis, two iconic statistical models.</p>
<section id="moving-average-model" class="level5">
<h5 class="anchored" data-anchor-id="moving-average-model">1. Moving Average model</h5>
<p>In MA model, the current realization is linearly dependent of past error terms. The script below defines a MA realization of size 1, and <code>q</code> defined as <code>0.4</code>.</p>
<div class="cell" data-tags="[]" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>SAMPLE_SIZE <span class="op">=</span> <span class="dv">750</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.zeros((SAMPLE_SIZE,))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># true stationarity</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>true_theta <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># true standard deviation of the innovation:</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>true_sigma <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># true process mean:</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>true_center <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>innovations <span class="op">=</span> np.random.normal(true_center, true_sigma, SAMPLE_SIZE)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, SAMPLE_SIZE):</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    y[t] <span class="op">=</span> innovations[t] <span class="op">+</span> true_theta <span class="op">*</span> innovations[t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>plt.plot(y, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Timestep"</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"$y$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>Text(0, 0.5, '$y$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># building covariance matrix and outcome vector.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"ma_sample"</span>] <span class="op">=</span> y</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"index"</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, SAMPLE_SIZE))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> add_constant(data)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data[[<span class="st">"const"</span>]]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">"ma_sample"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To find the best size for MA, the <code>q</code> fitting, we benchmark them by <code>pAIC</code>. Moreover, the <code>mc_ma</code> assist us in building the Z matrices for the MA analysis.</p>
<div class="cell" data-tags="[]" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>one_order <span class="op">=</span> [mc_id(X), mc_ma(<span class="bu">id</span><span class="op">=</span><span class="st">"const"</span>, time<span class="op">=</span><span class="st">"index"</span>, data<span class="op">=</span>data, order<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>two_order <span class="op">=</span> [<span class="op">*</span>one_order, mc_ma(<span class="bu">id</span><span class="op">=</span><span class="st">"const"</span>, time<span class="op">=</span><span class="st">"index"</span>, data<span class="op">=</span>data, order<span class="op">=</span><span class="dv">2</span>)]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>three_order <span class="op">=</span> [<span class="op">*</span>two_order, mc_ma(<span class="bu">id</span><span class="op">=</span><span class="st">"const"</span>, time<span class="op">=</span><span class="st">"index"</span>, data<span class="op">=</span>data, order<span class="op">=</span><span class="dv">3</span>)]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>four_order <span class="op">=</span> [<span class="op">*</span>three_order, mc_ma(<span class="bu">id</span><span class="op">=</span><span class="st">"const"</span>, time<span class="op">=</span><span class="st">"index"</span>, data<span class="op">=</span>data, order<span class="op">=</span><span class="dv">4</span>)]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>five_order <span class="op">=</span> [<span class="op">*</span>four_order, mc_ma(<span class="bu">id</span><span class="op">=</span><span class="st">"const"</span>, time<span class="op">=</span><span class="st">"index"</span>, data<span class="op">=</span>data, order<span class="op">=</span><span class="dv">5</span>)]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>six_order <span class="op">=</span> [<span class="op">*</span>five_order, mc_ma(<span class="bu">id</span><span class="op">=</span><span class="st">"const"</span>, time<span class="op">=</span><span class="st">"index"</span>, data<span class="op">=</span>data, order<span class="op">=</span><span class="dv">6</span>)]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>seven_order <span class="op">=</span> [<span class="op">*</span>six_order, mc_ma(<span class="bu">id</span><span class="op">=</span><span class="st">"const"</span>, time<span class="op">=</span><span class="st">"index"</span>, data<span class="op">=</span>data, order<span class="op">=</span><span class="dv">7</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-tags="[]" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, order <span class="kw">in</span> <span class="bu">enumerate</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    [one_order, two_order, three_order, four_order, five_order, six_order, seven_order]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    modelresults <span class="op">=</span> MCGLM(y, X, order).fit()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"q value: "</span>, <span class="bu">str</span>(index <span class="op">+</span> <span class="dv">1</span>), <span class="st">", paic: "</span>, modelresults.aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>q value:  1 , paic:  1349.04
q value:  2 , paic:  1350.11
q value:  3 , paic:  1352.11
q value:  4 , paic:  1351.55
q value:  5 , paic:  1353.06
q value:  6 , paic:  1355.05
q value:  7 , paic:  1356.43</code></pre>
</div>
</div>
<p>Displacement q as 1 as the best fit.</p>
<div class="cell" data-tags="[]" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>modelresults <span class="op">=</span> MCGLM(y, X, one_order).fit()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>[modelresults.summary()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>[&lt;class 'statsmodels.iolib.summary.Summary'&gt;
 """
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:              ma_sample   No. Iterations:                      3
 Model:                          MCGLM   No. Observations:                  750
 link:                        identity   Df Residuals:                      747
 variance:                    constant   Df Model:                            3
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                           1349.04
 Time:                        15:36:27   pBIC                            1362.9
                                         pLogLik                      -671.5208
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 const          0.0307      0.050      0.615      0.538      -0.067       0.129
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1     1.1080      0.060     18.437      0.000       0.990       1.226
 dispersion_2     0.3830      0.038     10.208      0.000       0.309       0.457
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
 ==============================================================================
 """]</code></pre>
</div>
</div>
<p>The summary report drills down the <span class="math inline">\(\theta\)</span> parameters that linearly operate the Gaussian White Noise, and 0.4, the actual value, falls within the interval of the second dispersion parameter.</p>
</section>
<section id="random-effect-models" class="level5">
<h5 class="anchored" data-anchor-id="random-effect-models">2. Random Effect models</h5>
<p>The dataset <code>sleepstudy</code> is a study of sleep deprivation. https://www.rdocumentation.org/packages/lme4/versions/1.1-26/topics/sleepstudy.</p>
<p>The study aims to understand the influence of sleep deprivation on reaction time. On day 0, subjects had their usual amount of sleep. From day 0 on, they were restricted to 3 hours of sleep per night. The observations represent the average reaction time on a series of tests given each day to each subject.</p>
<p>One promising approach is fitting through two-level effect models, such as <code>mixed models</code>. The <code>mcglm</code> library is a perfect framework to apply this statistical learning; due to the model and the method <code>mc_mixed()</code> to build a dependence matrix.</p>
<div class="cell" data-tags="[]" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 10 cells to get an intuition about data.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sleepstudy <span class="op">=</span> pd.read_csv(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/first_simulation/sleepstudy.csv"</span>, dtype<span class="op">=</span>{<span class="st">"Subject"</span>: <span class="st">"str"</span>}</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>sleepstudy.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Reaction</th>
      <th>Days</th>
      <th>Subject</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>249.5600</td>
      <td>0</td>
      <td>308</td>
    </tr>
    <tr>
      <th>1</th>
      <td>258.7047</td>
      <td>1</td>
      <td>308</td>
    </tr>
    <tr>
      <th>2</th>
      <td>250.8006</td>
      <td>2</td>
      <td>308</td>
    </tr>
    <tr>
      <th>3</th>
      <td>321.4398</td>
      <td>3</td>
      <td>308</td>
    </tr>
    <tr>
      <th>4</th>
      <td>356.8519</td>
      <td>4</td>
      <td>308</td>
    </tr>
    <tr>
      <th>5</th>
      <td>414.6901</td>
      <td>5</td>
      <td>308</td>
    </tr>
    <tr>
      <th>6</th>
      <td>382.2038</td>
      <td>6</td>
      <td>308</td>
    </tr>
    <tr>
      <th>7</th>
      <td>290.1486</td>
      <td>7</td>
      <td>308</td>
    </tr>
    <tr>
      <th>8</th>
      <td>430.5853</td>
      <td>8</td>
      <td>308</td>
    </tr>
    <tr>
      <th>9</th>
      <td>466.3535</td>
      <td>9</td>
      <td>308</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Plotting curve of 18 subjects</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> sns.lineplot(x<span class="op">=</span><span class="st">"Days"</span>, y<span class="op">=</span><span class="st">"Reaction"</span>, hue<span class="op">=</span><span class="st">"Subject"</span>, data<span class="op">=</span>sleepstudy)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>&lt;matplotlib.legend.Legend at 0x7f9dedbe63a0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Design Matrix</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dmatrix(<span class="st">"~ Days"</span>, sleepstudy, return_type<span class="op">=</span><span class="st">"dataframe"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Z specification</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> [mc_id(sleepstudy)] <span class="op">+</span> mc_mixed(formula<span class="op">=</span><span class="st">"~ 0 + Subject / Days"</span>, data<span class="op">=</span>sleepstudy)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fitting</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>mcglm <span class="op">=</span> MCGLM(endog<span class="op">=</span>sleepstudy[<span class="st">"Reaction"</span>], exog<span class="op">=</span>X, z<span class="op">=</span>Z)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>mcglmresults <span class="op">=</span> mcglm.fit()</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>[mcglmresults.summary()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>[&lt;class 'statsmodels.iolib.summary.Summary'&gt;
 """
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:               Reaction   No. Iterations:                      1
 Model:                          MCGLM   No. Observations:                  180
 link:                        identity   Df Residuals:                      174
 variance:                    constant   Df Model:                            6
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                           1583.94
 Time:                        15:36:43   pBIC                            1603.1
                                         pLogLik                      -785.9702
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 Intercept    251.4051      6.632     37.906      0.000     238.406     264.404
 Days          10.4673      1.502      6.968      0.000       7.523      13.412
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1   654.9410     70.624      9.274      0.000     516.521     793.361
 dispersion_2   565.5150    264.679      2.137      0.033      46.753    1084.277
 dispersion_3    32.6820     13.560      2.410      0.016       6.105      59.259
 dispersion_4    11.0550     42.948      0.257      0.797     -73.121      95.231
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
 ==============================================================================
 """]</code></pre>
</div>
</div>
<ul>
<li><p>Regression coefficients<br>
The regression section diagnose the fixed-effects parameters, that is to say, the conclusion overall subjects.</p>
<p>Intercept set at value 251.40. The straightforward takeaway is: At day 0, the average response time is roughly 251 seconds. In addition, Days at 10.46 allude to total change to response time by unit changes on Days, for subjects with random effects set to 0. Furthermore, by the results of the wald test on Days, we might conclude that days are statistically significant for the model.</p></li>
<li><p>Dispersion parameters<br>
The dispersion parameters allude to random effects within individuals throughout the days.</p>
<p>The first dispersion parameter is the variance across all data points. Calculated in 654.94. The second dispersion parameter is the variance across all intercepts, which is 565.51. The third dispersion parameter is the variance across all slopes. Calculated in 32.68. The fourth dispersion parameter is the variance across intercepts and slopes. Calculated in 11.05.</p></li>
<li><p>Moreover, the correlation might be calculated through the formula = dispersion_4/sqrt(dispersion_2 * dispersion_3). Cell below shows the pearson correlation result, 0.0812.</p></li>
</ul>
<p>Furthermore, <code>mcglm</code> can also do multivariate analysis.</p>
</section>
<section id="multivariate-models" class="level4">
<h4 class="anchored" data-anchor-id="multivariate-models">Multivariate Models</h4>
<p>Soya</p>
<p><code>Soya</code> is a dataset that stores an experiment of Universidade Federal da Grande Dourados in Dourados, Mato Grosso do Sul, Brazil. Description:<br>
https://github.com/walmes/wzRfun/blob/master/R/wzRfun.R#L10<br>
http://ccarevista.ufc.br/seer/index.php/ccarevista/article/view/1454</p>
<p>The experiment collected data about different treatments of <code>potassium</code>, <code>water</code>, and <code>blocks</code> for soil farming on buckets. All of those covariates are categorical. The response traits to be analyzed are: <code>grain size</code>, <code>total seeds</code>, and <code>viable peas</code>, which stands for the weight of hundred grains, total grain per bucket, and percentage of viable peas(green beans). In the following, MCGLM fits onto this data with three unique answers: continuous, count, and binomial.</p>
<div class="cell" data-tags="[]" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>soya <span class="op">=</span> pd.read_csv(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/fourth_simulation/soya.csv"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    dtype<span class="op">=</span>{<span class="st">"block"</span>: <span class="st">"str"</span>, <span class="st">"water"</span>: <span class="st">"str"</span>, <span class="st">"pot"</span>: <span class="st">"str"</span>},</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># percentual of peas.</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>soya[<span class="st">"viablePeas"</span>] <span class="op">=</span> soya[<span class="st">"viablepeas"</span>] <span class="op">/</span> soya[<span class="st">"totalpeas"</span>]</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Design matrix.</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dmatrix(<span class="st">"~ block + water * pot"</span>, soya, return_type<span class="op">=</span><span class="st">"dataframe"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Specification</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>mcglm <span class="op">=</span> MCGLM(</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    endog<span class="op">=</span>[soya[<span class="st">"grain"</span>], soya[<span class="st">"seeds"</span>], soya[<span class="st">"viablePeas"</span>]],</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    exog<span class="op">=</span>[X, X, X],</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    z<span class="op">=</span>[[mc_id(soya)], [mc_id(soya)], [mc_id(soya)]],</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    link<span class="op">=</span>[<span class="st">"identity"</span>, <span class="st">"log"</span>, <span class="st">"logit"</span>],</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    variance<span class="op">=</span>[<span class="st">"constant"</span>, <span class="st">"tweedie"</span>, <span class="st">"binomialP"</span>],</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    ntrial<span class="op">=</span>[<span class="va">None</span>, <span class="va">None</span>, soya[<span class="st">"totalpeas"</span>].values],</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>mcglmresults <span class="op">=</span> mcglm.fit()</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>[mcglmresults.summary()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>[&lt;class 'statsmodels.iolib.summary.Summary'&gt;
 """
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:                  grain   No. Iterations:                      3
 Model:                          MCGLM   No. Observations:                   75
 link:                        identity   Df Residuals:                       55
 variance:                    constant   Df Model:                           20
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                            448.02
 Time:                        15:36:51   pBIC                            516.34
                                         pLogLik                      -204.0085
 ============================================================================================
                                coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------------------
 Intercept                   14.2455      1.217     11.701      0.000      11.859      16.632
 block[T.II]                  1.1326      0.880      1.287      0.198      -0.593       2.858
 block[T.III]                -0.7797      0.880     -0.886      0.376      -2.505       0.946
 block[T.IV]                 -1.5495      0.880     -1.760      0.078      -3.275       0.176
 block[T.V]                  -2.3866      0.880     -2.711      0.007      -4.112      -0.661
 water[T.50]                  2.1660      1.531      1.415      0.157      -0.834       5.166
 water[T.62.5]                2.5404      1.531      1.660      0.097      -0.460       5.541
 pot[T.120]                  11.7898      1.531      7.702      0.000       8.790      14.790
 pot[T.180]                  11.8633      1.531      7.750      0.000       8.863      14.864
 pot[T.30]                    6.7894      1.531      4.435      0.000       3.789       9.790
 pot[T.60]                   10.3978      1.531      6.793      0.000       7.398      13.398
 water[T.50]:pot[T.120]       2.2541      2.165      1.041      0.298      -1.989       6.497
 water[T.62.5]:pot[T.120]     5.5826      2.165      2.579      0.010       1.340       9.826
 water[T.50]:pot[T.180]       1.2097      2.165      0.559      0.576      -3.033       5.453
 water[T.62.5]:pot[T.180]     9.2391      2.165      4.268      0.000       4.996      13.482
 water[T.50]:pot[T.30]        0.1069      2.165      0.049      0.961      -4.136       4.350
 water[T.62.5]:pot[T.30]     -1.8677      2.165     -0.863      0.388      -6.111       2.375
 water[T.50]:pot[T.60]        2.6035      2.165      1.203      0.229      -1.640       6.847
 water[T.62.5]:pot[T.60]      3.3585      2.165      1.551      0.121      -0.885       7.602
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1     5.8610      1.671      3.507      0.000       2.586       9.136
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:                  seeds   No. Iterations:                      3
 Model:                          MCGLM   No. Observations:                   75
 link:                             log   Df Residuals:                       55
 variance:                     tweedie   Df Model:                           20
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                            448.02
 Time:                        15:36:51   pBIC                            516.34
                                         pLogLik                      -204.0085
 ============================================================================================
                                coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------------------
 Intercept                    4.8074      0.066     73.109      0.000       4.679       4.936
 block[T.II]                 -0.0182      0.039     -0.469      0.639      -0.094       0.058
 block[T.III]                -0.0330      0.039     -0.845      0.398      -0.110       0.044
 block[T.IV]                 -0.1066      0.040     -2.679      0.007      -0.185      -0.029
 block[T.V]                  -0.1261      0.040     -3.154      0.002      -0.205      -0.048
 water[T.50]                  0.1322      0.084      1.580      0.114      -0.032       0.296
 water[T.62.5]                0.1864      0.083      2.255      0.024       0.024       0.348
 pot[T.120]                   0.3672      0.079      4.620      0.000       0.211       0.523
 pot[T.180]                   0.2945      0.081      3.649      0.000       0.136       0.453
 pot[T.30]                    0.2980      0.081      3.696      0.000       0.140       0.456
 pot[T.60]                    0.3444      0.080      4.313      0.000       0.188       0.501
 water[T.50]:pot[T.120]       0.1159      0.108      1.076      0.282      -0.095       0.327
 water[T.62.5]:pot[T.120]     0.0697      0.107      0.653      0.514      -0.140       0.279
 water[T.50]:pot[T.180]       0.2906      0.108      2.697      0.007       0.079       0.502
 water[T.62.5]:pot[T.180]     0.2166      0.107      2.023      0.043       0.007       0.426
 water[T.50]:pot[T.30]        0.0425      0.110      0.386      0.699      -0.173       0.258
 water[T.62.5]:pot[T.30]     -0.1372      0.111     -1.241      0.215      -0.354       0.080
 water[T.50]:pot[T.60]        0.1161      0.108      1.073      0.283      -0.096       0.328
 water[T.62.5]:pot[T.60]      0.0902      0.107      0.842      0.400      -0.120       0.300
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1     2.1620      0.429      5.034      0.000       1.320       3.004
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
                Multivariate Covariance Generalized Linear Model               
 ==============================================================================
 Dep. Variable:             viablePeas   No. Iterations:                      3
 Model:                          MCGLM   No. Observations:                   75
 link:                           logit   Df Residuals:                       55
 variance:                   binomialP   Df Model:                           20
 Method:              Quasi-Likelihood   Power-fixed:                      True
 Date:                Sun, 05 Feb 2023   pAIC                            448.02
 Time:                        15:36:51   pBIC                            516.34
                                         pLogLik                      -204.0085
 ============================================================================================
                                coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------------------
 Intercept                   -0.8360      0.197     -4.241      0.000      -1.222      -0.450
 block[T.II]                 -0.4383      0.188     -2.329      0.020      -0.807      -0.069
 block[T.III]                -0.1671      0.183     -0.913      0.361      -0.526       0.191
 block[T.IV]                 -0.1877      0.183     -1.023      0.306      -0.547       0.172
 block[T.V]                  -0.2926      0.187     -1.564      0.118      -0.659       0.074
 water[T.50]                  0.5675      0.218      2.603      0.009       0.140       0.995
 water[T.62.5]                0.2414      0.219      1.102      0.271      -0.188       0.671
 pot[T.120]                  -3.3915      0.597     -5.682      0.000      -4.562      -2.222
 pot[T.180]                  -3.6309      0.685     -5.299      0.000      -4.974      -2.288
 pot[T.30]                   -1.8455      0.330     -5.600      0.000      -2.491      -1.200
 pot[T.60]                   -3.1518      0.541     -5.825      0.000      -4.212      -2.091
 water[T.50]:pot[T.120]       0.6881      0.672      1.024      0.306      -0.629       2.005
 water[T.62.5]:pot[T.120]    -0.8359      0.910     -0.918      0.359      -2.620       0.948
 water[T.50]:pot[T.180]       1.2731      0.735      1.732      0.083      -0.167       2.714
 water[T.62.5]:pot[T.180]     0.0683      0.842      0.081      0.935      -1.582       1.718
 water[T.50]:pot[T.30]       -0.2773      0.425     -0.653      0.514      -1.110       0.555
 water[T.62.5]:pot[T.30]      0.8046      0.400      2.013      0.044       0.021       1.588
 water[T.50]:pot[T.60]        0.4598      0.623      0.739      0.460      -0.760       1.680
 water[T.62.5]:pot[T.60]      0.6312      0.630      1.002      0.317      -0.604       1.866
 ================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
 --------------------------------------------------------------------------------
 dispersion_1     1.2970      0.245      5.294      0.000       0.817       1.777
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 power_         1.0000        nan        nan        nan         nan         nan
 ==============================================================================
                  coef    std err          z      P&gt;|z|      [0.025      0.975]
 ------------------------------------------------------------------------------
 rho_1          0.6373      0.107      5.930      0.000       0.427       0.848
 rho_2          0.0696      0.115      0.604      0.546      -0.156       0.295
 rho_3          0.0878      0.115      0.765      0.444      -0.137       0.313
 ==============================================================================
 """]</code></pre>
</div>
</div>
<p>The three responses have generated a three-section report, an analysis per response.</p>
<p><code>grain</code> size.</p>
<p>The grain response was fitted with default parameters, <code>identity</code> and <code>constant</code>, generating a near homoscedastic linear model. Among covariates <code>block</code>, <code>water</code> and <code>potassium</code>, by Wald test, potassium levels are statistically significant for the model; the higher the potassium level, the bigger grain size. Variance is constant on 5.862.</p>
<p>Residual analysis:</p>
<div class="cell" data-tags="[]" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grain. residual analysis</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(mcglmresults.mu[<span class="dv">0</span>], mcglmresults.pearson_residuals[<span class="dv">0</span>])</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"mu"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"pearson residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>Text(0, 0.5, 'pearson residuals')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-25-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The fitting looks good.</p>
<p><code>seed</code> count.</p>
<p>As long as <code>seed</code> is a count variable, a straightforward and canonical way to model it is Poisson. Out of three, two covariates are statistically significant on <code>seed</code>: potassium for every level; and black for level V.</p>
<p>Residual analysis:</p>
<div class="cell" data-tags="[]" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seeds. residual analysis</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(mcglmresults.mu[<span class="dv">1</span>], mcglmresults.pearson_residuals[<span class="dv">1</span>])</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"mu"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"pearson residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>Text(0, 0.5, 'pearson residuals')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The fitting seems good.</p>
<p>Percentage of <code>viable peas</code>.</p>
<p>Binomial N trials are the adequate model for bounded data. Perhaps, the most popular solution to fit is the <code>Logit</code> link, the one used. Among covariates, only potassium level 30, and water level 50 are statistically significant with Viable Peas.</p>
<p>Residual Analysis:</p>
<div class="cell" data-tags="[]" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># viablepeasP. residual analysis</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(mcglmresults.mu[<span class="dv">2</span>], mcglmresults.pearson_residuals[<span class="dv">2</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"mu"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"pearson residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>Text(0, 0.5, 'pearson residuals')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="tutorial_mcglm_files/figure-html/cell-27-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The last three components’ rhos allude to the correlation coefficient among responses. * rho_1 stands for grain size and whole seeds, with a considerable Pearson correlation of 0.63. * rho_2 and rho_3 dispersion parameters represent the correlation between grain size and viable peas, seed count, and viable peas, respectively. Both correlations are low.</p>
<p>Do not hesitate to leverage <code>mcglm</code> on your analysis and leave feedback. Thanks.</p>
<hr>
<p>References</p>
<p>[1] Stigler SM (1981). “Gauss and the Invention of Least Squares.” The Annals of Statistics, 9(3), 465 – 474. doi:10.1214/aos/1176345451. URL https://doi.org/10.1214/aos/1176345451<br>
[2] Hallin M (2014). Gauss–Markov Theorem in Statistics. ISBN 9781118445112. doi:10.1002/9781118445112.stat07536.<br>
[3] Narula SC, Wellington JF (1982). “The Minimum Sum of Absolute Errors Regression: A State of the Art Survey.”<br>
[4] Galton F (1886). “Regression towards mediocrity in hereditary stature.” Journal of the Anthropological Institute of Great Britain and Ireland, pp.&nbsp;246–263.<br>
[5] Seal HL (1967). “Studies in the History of Probability and Statistics. XV: The Historical Development of the Gauss Linear Model.” Biometrika, 54(1/2), 1–24. ISSN 00063444. URL http://www.jstor.org/stable/2333849.<br>
[6] Nelder J, Wedderburn R (1972). “Generalized Linear Models.” pp.&nbsp;370–384. doi:https://doi.org/10.2307/2344614.<br>
[7] M ̈uller M (2004). “Generalized Linear Models.” doi:10.1007/978-3-642-21551-3_24.<br>
[8] Hastie T, Tibshirani R (1986). “Generalized additive models (with discussion).” Statistical Science 1, p.&nbsp;297–318.<br>
[9] Liang KY, Zeger SL (1986). “Longitudinal Data Analysis Using Generalized Linear Models.” Biometrika, 73(1), 13–22.<br>
[10] Krupskii P, Joe H (2013). “Factor Copula Models for Multivariate Data.” Journal of Multivariate Analysis, 120(1), 85–101.<br>
[11] Masarotto G, Varin C (2012). “Gaussian Copula Marginal Regression.” Electronic Journal of Statistics, 6, 1517–1549.<br>
[12] Verbeke G, Fieuws S, Molenberghs G, Davidian M (2014). “The Analysis of Multivariate Longitudinal Data: A Review.” Statistical Methods in Medical Research, 23(1), 42–59.<br>
[13] Bonat WH, Jørgensen B (2016). “Multivariate Covariance Generalized Linear Models.” Journal of the Royal Statistical Society C, 65(5), 649–675. doi:10.1111/rssc.12145. [14] Jennrich RI (1969). “A Newton-Raphson algorithm for maximum likelihood factor analysis.” Psychometrika, 34. ISSN 1860-0980. doi:10.1093/biomet/61.3.439. URL https://doi.org/10.1007/BF02290176.<br>
[15] Widyaningsih P, Saputro D, Putri A (2017). “Fisher Scoring Method for Parameter Estimation of Geographically Weighted Ordinal Logistic Regression (GWOLR) Model.” Journal of Physics: Conference Series, 855, 012060. doi:10.1088/1742-6596/855/1/012060<br>
[16] Jørgensen B, Knudsen SJ (2004). “Parameter Orthogonality and Bias Adjustment for Estimating Functions.” Scandinavian Journal of Statistics, 31(1), 93–114.<br>
[17] Wedderburn RWM (1974). “Quasi likelihood functions, generalized linear models, and the Gauss—Newton method.” Biometrika, 61(3), 439–447. ISSN 0006-3444. doi:10.1093/biomet/61.3.439. https://academic.oup.com/biomet/article-pdf/61/3/439/690500/61-3-439.pdf, URL https://doi.org/10.1093/biomet/61.3.439.<br>
[18] Martinez-Beneito MA (2013). “A General Modelling Framework for Multivariate Disease Mapping.” Biometrika, 100(3), 539–553.<br>
[19] Anderson TW (1973). “Asymptotically Efficient Estimation of Covariance Matrices with Linear Structure.” The Annals of Statistics, 1(1), 135–141.<br>
[20] Pourahmadi M (2000). “Maximum Likelihood Estimation of Generalized Linear Models for Multivariate Normal Covariance Matrix.” Biometrika, 87(2), 425–435.<br>
[21] Bonat WH (2016). “Modelling Mixed Outcomes in Additive Genetic Models.” ArXiv.<br>
[22] Chiu TYM Leonard T TK (1996). “The Matrix-Logarithmic Covariance Model.” Journal of the American Statistical Association. doi:10.1080/01621459.1996.10476677.<br>
[23] Jørgensen B (1987). “Exponential dispersion models.” Journal of the Royal Statistical Society.<br>
[24] Jørgensen B (1997). “The theory of dispersion models.” CRC Press.<br>
[25] Jørgensen B, Kokonendji CC (2015). “Discrete dispersion models and their tweedie asymptotics.” AStA Advances in Statistical Analysis, 100(1), p.&nbsp;43–78.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>